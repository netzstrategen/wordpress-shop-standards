/* global jQuery, _ */
(function pageLoad($) {
  /**
   * Checks GTIN for uniqueness and issues an error/success message.
   */
  $(document).on('keyup', "input[name*='_shop-standards_gtin']", _.debounce(function (event) {
    var $gtinInput = $(event.currentTarget);
    var $gtinField = $gtinInput.parents('.form-field');
    $gtinField.find('.notice').remove();

    if ($gtinField.find('.spinner').length === 0) {
      $gtinField.append('<span class="spinner"></span>');
    }

    $gtinField.find('.spinner').addClass('is-active');
    jQuery.post(window.ajaxurl, {
      action: 'is_existing_gtin',
      product_id: window.shop_standards_admin.product_id,
      gtin: $gtinInput.val()
    }, function (response) {
      $gtinField.find('.spinner').removeClass('is-active');
      $gtinField.find('.notice').remove();

      if (response.is_unique) {
        var message = window.shop_standards_admin.gtin_success_message;
        $gtinField.append("\n            <div class=\"notice notice-success\">\n              ".concat(message, "\n            </div>\n          "));
      } else {
        var _message = window.shop_standards_admin.gtin_error_message.replace('{{url}}', response.duplicate_edit_link);

        $gtinField.append("\n            <div class=\"notice notice-error\">\n              ".concat(_message, "\n            </div>\n          "));
      }
    }, 'json');
  }, 500));
})(jQuery);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluLmpzIl0sIm5hbWVzIjpbInBhZ2VMb2FkIiwiJCIsImRvY3VtZW50Iiwib24iLCJfIiwiZGVib3VuY2UiLCJldmVudCIsIiRndGluSW5wdXQiLCJjdXJyZW50VGFyZ2V0IiwiJGd0aW5GaWVsZCIsInBhcmVudHMiLCJmaW5kIiwicmVtb3ZlIiwibGVuZ3RoIiwiYXBwZW5kIiwiYWRkQ2xhc3MiLCJqUXVlcnkiLCJwb3N0Iiwid2luZG93IiwiYWpheHVybCIsImFjdGlvbiIsInByb2R1Y3RfaWQiLCJzaG9wX3N0YW5kYXJkc19hZG1pbiIsImd0aW4iLCJ2YWwiLCJyZXNwb25zZSIsInJlbW92ZUNsYXNzIiwiaXNfdW5pcXVlIiwibWVzc2FnZSIsImd0aW5fc3VjY2Vzc19tZXNzYWdlIiwiZ3Rpbl9lcnJvcl9tZXNzYWdlIiwicmVwbGFjZSIsImR1cGxpY2F0ZV9lZGl0X2xpbmsiXSwibWFwcGluZ3MiOiJBQUFBO0FBRUMsVUFBU0EsUUFBVCxDQUFrQkMsQ0FBbEIsRUFBcUI7QUFDcEI7QUFDRjtBQUNBO0FBQ0VBLEVBQUFBLENBQUMsQ0FBQ0MsUUFBRCxDQUFELENBQVlDLEVBQVosQ0FBZSxPQUFmLEVBQXdCLHFDQUF4QixFQUErREMsQ0FBQyxDQUFDQyxRQUFGLENBQVcsVUFBQ0MsS0FBRCxFQUFXO0FBQ25GLFFBQU1DLFVBQVUsR0FBR04sQ0FBQyxDQUFDSyxLQUFLLENBQUNFLGFBQVAsQ0FBcEI7QUFDQSxRQUFNQyxVQUFVLEdBQUdGLFVBQVUsQ0FBQ0csT0FBWCxDQUFtQixhQUFuQixDQUFuQjtBQUNBRCxJQUFBQSxVQUFVLENBQUNFLElBQVgsQ0FBZ0IsU0FBaEIsRUFBMkJDLE1BQTNCOztBQUNBLFFBQUlILFVBQVUsQ0FBQ0UsSUFBWCxDQUFnQixVQUFoQixFQUE0QkUsTUFBNUIsS0FBdUMsQ0FBM0MsRUFBOEM7QUFDNUNKLE1BQUFBLFVBQVUsQ0FBQ0ssTUFBWCxDQUFrQiwrQkFBbEI7QUFDRDs7QUFDREwsSUFBQUEsVUFBVSxDQUFDRSxJQUFYLENBQWdCLFVBQWhCLEVBQTRCSSxRQUE1QixDQUFxQyxXQUFyQztBQUVBQyxJQUFBQSxNQUFNLENBQUNDLElBQVAsQ0FDRUMsTUFBTSxDQUFDQyxPQURULEVBRUU7QUFDRUMsTUFBQUEsTUFBTSxFQUFFLGtCQURWO0FBRUVDLE1BQUFBLFVBQVUsRUFBRUgsTUFBTSxDQUFDSSxvQkFBUCxDQUE0QkQsVUFGMUM7QUFHRUUsTUFBQUEsSUFBSSxFQUFFaEIsVUFBVSxDQUFDaUIsR0FBWDtBQUhSLEtBRkYsRUFPRSxVQUFDQyxRQUFELEVBQWM7QUFDWmhCLE1BQUFBLFVBQVUsQ0FBQ0UsSUFBWCxDQUFnQixVQUFoQixFQUE0QmUsV0FBNUIsQ0FBd0MsV0FBeEM7QUFDQWpCLE1BQUFBLFVBQVUsQ0FBQ0UsSUFBWCxDQUFnQixTQUFoQixFQUEyQkMsTUFBM0I7O0FBRUEsVUFBSWEsUUFBUSxDQUFDRSxTQUFiLEVBQXdCO0FBQ3RCLFlBQU1DLE9BQU8sR0FBR1YsTUFBTSxDQUFDSSxvQkFBUCxDQUE0Qk8sb0JBQTVDO0FBQ0FwQixRQUFBQSxVQUFVLENBQUNLLE1BQVgsOEVBRU1jLE9BRk47QUFLRCxPQVBELE1BT087QUFDTCxZQUFNQSxRQUFPLEdBQUdWLE1BQU0sQ0FBQ0ksb0JBQVAsQ0FBNEJRLGtCQUE1QixDQUErQ0MsT0FBL0MsQ0FBdUQsU0FBdkQsRUFBa0VOLFFBQVEsQ0FBQ08sbUJBQTNFLENBQWhCOztBQUNBdkIsUUFBQUEsVUFBVSxDQUFDSyxNQUFYLDRFQUVNYyxRQUZOO0FBS0Q7QUFDRixLQTFCSCxFQTJCRSxNQTNCRjtBQTZCRCxHQXRDOEQsRUFzQzVELEdBdEM0RCxDQUEvRDtBQXVDRCxDQTNDQSxFQTJDQ1osTUEzQ0QsQ0FBRCIsInNvdXJjZXNDb250ZW50IjpbIi8qIGdsb2JhbCBqUXVlcnksIF8gKi9cblxuKGZ1bmN0aW9uIHBhZ2VMb2FkKCQpIHtcbiAgLyoqXG4gICAqIENoZWNrcyBHVElOIGZvciB1bmlxdWVuZXNzIGFuZCBpc3N1ZXMgYW4gZXJyb3Ivc3VjY2VzcyBtZXNzYWdlLlxuICAgKi9cbiAgJChkb2N1bWVudCkub24oJ2tleXVwJywgXCJpbnB1dFtuYW1lKj0nX3Nob3Atc3RhbmRhcmRzX2d0aW4nXVwiLCBfLmRlYm91bmNlKChldmVudCkgPT4ge1xuICAgIGNvbnN0ICRndGluSW5wdXQgPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xuICAgIGNvbnN0ICRndGluRmllbGQgPSAkZ3RpbklucHV0LnBhcmVudHMoJy5mb3JtLWZpZWxkJyk7XG4gICAgJGd0aW5GaWVsZC5maW5kKCcubm90aWNlJykucmVtb3ZlKCk7XG4gICAgaWYgKCRndGluRmllbGQuZmluZCgnLnNwaW5uZXInKS5sZW5ndGggPT09IDApIHtcbiAgICAgICRndGluRmllbGQuYXBwZW5kKCc8c3BhbiBjbGFzcz1cInNwaW5uZXJcIj48L3NwYW4+Jyk7XG4gICAgfVxuICAgICRndGluRmllbGQuZmluZCgnLnNwaW5uZXInKS5hZGRDbGFzcygnaXMtYWN0aXZlJyk7XG5cbiAgICBqUXVlcnkucG9zdChcbiAgICAgIHdpbmRvdy5hamF4dXJsLFxuICAgICAge1xuICAgICAgICBhY3Rpb246ICdpc19leGlzdGluZ19ndGluJyxcbiAgICAgICAgcHJvZHVjdF9pZDogd2luZG93LnNob3Bfc3RhbmRhcmRzX2FkbWluLnByb2R1Y3RfaWQsXG4gICAgICAgIGd0aW46ICRndGluSW5wdXQudmFsKCksXG4gICAgICB9LFxuICAgICAgKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICRndGluRmllbGQuZmluZCgnLnNwaW5uZXInKS5yZW1vdmVDbGFzcygnaXMtYWN0aXZlJyk7XG4gICAgICAgICRndGluRmllbGQuZmluZCgnLm5vdGljZScpLnJlbW92ZSgpO1xuXG4gICAgICAgIGlmIChyZXNwb25zZS5pc191bmlxdWUpIHtcbiAgICAgICAgICBjb25zdCBtZXNzYWdlID0gd2luZG93LnNob3Bfc3RhbmRhcmRzX2FkbWluLmd0aW5fc3VjY2Vzc19tZXNzYWdlO1xuICAgICAgICAgICRndGluRmllbGQuYXBwZW5kKGBcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJub3RpY2Ugbm90aWNlLXN1Y2Nlc3NcIj5cbiAgICAgICAgICAgICAgJHttZXNzYWdlfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgYCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3QgbWVzc2FnZSA9IHdpbmRvdy5zaG9wX3N0YW5kYXJkc19hZG1pbi5ndGluX2Vycm9yX21lc3NhZ2UucmVwbGFjZSgne3t1cmx9fScsIHJlc3BvbnNlLmR1cGxpY2F0ZV9lZGl0X2xpbmspO1xuICAgICAgICAgICRndGluRmllbGQuYXBwZW5kKGBcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJub3RpY2Ugbm90aWNlLWVycm9yXCI+XG4gICAgICAgICAgICAgICR7bWVzc2FnZX1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIGApO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgJ2pzb24nLFxuICAgICk7XG4gIH0sIDUwMCkpO1xufShqUXVlcnkpKTtcbiJdLCJmaWxlIjoiYWRtaW4uanMifQ==